<!DOCTYPE html>
<html lang="pt-BR">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>Sistema de Reservas - Restaurante</title>
ย ย <style>
ย ย ย ย * {
ย ย ย ย ย ย margin: 0;
ย ย ย ย ย ย padding: 0;
ย ย ย ย ย ย box-sizing: border-box;
ย ย ย ย }

ย ย ย ย body {
ย ย ย ย ย ย font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
ย ย ย ย ย ย background: linear-gradient(135deg, #9F0402 0%, #9F0402 100%);
ย ย ย ย ย ย min-height: 100vh;
ย ย ย ย ย ย padding: 20px;
ย ย ย ย }

ย ย ย ย .container {
ย ย ย ย ย ย max-width: 1200px;
ย ย ย ย ย ย margin: 0 auto;
ย ย ย ย }

ย ย ย ย /* Interface Cliente */
ย ย ย ย .client-view {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย min-height: calc(100vh - 40px);
ย ย ย ย }

ย ย ย ย .reservation-card {
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย padding: 40px;
ย ย ย ย ย ย box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย max-width: 500px;
ย ย ย ย ย ย animation: slideUp 0.5s ease;
ย ย ย ย }

ย ย ย ย @keyframes slideUp {
ย ย ย ย ย ย from {
ย ย ย ย ย ย ย ย opacity: 0;
ย ย ย ย ย ย ย ย transform: translateY(30px);
ย ย ย ย ย ย }
ย ย ย ย ย ย to {
ย ย ย ย ย ย ย ย opacity: 1;
ย ย ย ย ย ย ย ย transform: translateY(0);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย h1 {
ย ย ย ย ย ย color: #333;
ย ย ย ย ย ย margin-bottom: 10px;
ย ย ย ย ย ย font-size: 28px;
ย ย ย ย }

ย ย ย ย .subtitle {
ย ย ย ย ย ย color: #666;
ย ย ย ย ย ย margin-bottom: 30px;
ย ย ย ย ย ย font-size: 14px;
ย ย ย ย }

ย ย ย ย .form-group {
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย }

ย ย ย ย label {
ย ย ย ย ย ย display: block;
ย ย ย ย ย ย margin-bottom: 5px;
ย ย ย ย ย ย color: #555;
ย ย ย ย ย ย font-weight: 500;
ย ย ย ย ย ย font-size: 14px;
ย ย ย ย }

ย ย ย ย input, select {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย padding: 12px;
ย ย ย ย ย ย border: 2px solid #e0e0e0;
ย ย ย ย ย ย border-radius: 10px;
ย ย ย ย ย ย font-size: 16px;
ย ย ย ย ย ย transition: all 0.3s;
ย ย ย ย }

ย ย ย ย input:focus, select:focus {
ย ย ย ย ย ย outline: none;
ย ย ย ย ย ย border-color: #667eea;
ย ย ย ย ย ย box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
ย ย ย ย }

ย ย ย ย input:disabled, select:disabled {
ย ย ย ย ย ย background-color: #f5f5f5;
ย ย ย ย ย ย color: #999;
ย ย ย ย ย ย cursor: not-allowed;
ย ย ย ย }

ย ย ย ย .datetime-group {
ย ย ย ย ย ย display: grid;
ย ย ย ย ย ย grid-template-columns: 1fr 1fr;
ย ย ย ย ย ย gap: 15px;
ย ย ย ย }

ย ย ย ย button {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย padding: 14px;
ย ย ย ย ย ย background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย border-radius: 10px;
ย ย ย ย ย ย font-size: 16px;
ย ย ย ย ย ย font-weight: 600;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย transition: transform 0.2s, box-shadow 0.2s;
ย ย ย ย }

ย ย ย ย button:hover:not(:disabled) {
ย ย ย ย ย ย transform: translateY(-2px);
ย ย ย ย ย ย box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
ย ย ย ย }

ย ย ย ย button:active:not(:disabled) {
ย ย ย ย ย ย transform: translateY(0);
ย ย ย ย }

ย ย ย ย button:disabled {
ย ย ย ย ย ย background: #ccc;
ย ย ย ย ย ย cursor: not-allowed;
ย ย ย ย }

ย ย ย ย /* Confirmaรงรฃo */
ย ย ย ย .confirmation {
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย padding: 30px;
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
ย ย ย ย ย ย animation: slideUp 0.5s ease;
ย ย ย ย }

ย ย ย ย .confirmation h2 {
ย ย ย ย ย ย color: #FF9800;
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย ย ย font-size: 24px;
ย ย ย ย }

ย ย ย ย .confirmation p {
ย ย ย ย ย ย color: #666;
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย ย ย line-height: 1.6;
ย ย ย ย }

ย ย ย ย .btn-new {
ย ย ย ย ย ย background: #4CAF50;
ย ย ย ย ย ย margin-top: 20px;
ย ย ย ย }

ย ย ย ย /* Interface Host */
ย ย ย ย .host-view {
ย ย ย ย ย ย display: none;
ย ย ย ย }

ย ย ย ย .host-header {
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย padding: 30px;
ย ย ย ย ย ย margin-bottom: 30px;
ย ย ย ย ย ย box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
ย ย ย ย }

ย ย ย ย .host-title {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: space-between;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย }

ย ย ย ย .filters {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย gap: 15px;
ย ย ย ย ย ย flex-wrap: wrap;
ย ย ย ย }

ย ย ย ย .filter-group {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย gap: 10px;
ย ย ย ย }

ย ย ย ย .filter-group label {
ย ย ย ย ย ย margin: 0;
ย ย ย ย ย ย font-weight: 600;
ย ย ย ย }

ย ย ย ย .filter-group input, .filter-group select {
ย ย ย ย ย ย width: auto;
ย ย ย ย ย ย padding: 8px 12px;
ย ย ย ย }

ย ย ย ย .reservations-grid {
ย ย ย ย ย ย display: grid;
ย ย ย ย ย ย gap: 20px;
ย ย ย ย }

ย ย ย ย .reservation-item {
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 15px;
ย ย ย ย ย ย padding: 20px;
ย ย ย ย ย ย box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: space-between;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย transition: transform 0.2s, box-shadow 0.2s;
ย ย ย ย }

ย ย ย ย .reservation-item:hover {
ย ย ย ย ย ย transform: translateY(-3px);
ย ย ย ย ย ย box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
ย ย ย ย }

ย ย ย ย .reservation-info {
ย ย ย ย ย ย flex: 1;
ย ย ย ย }

ย ย ย ย .reservation-name {
ย ย ย ย ย ย font-size: 18px;
ย ย ย ย ย ย font-weight: 600;
ย ย ย ย ย ย color: #333;
ย ย ย ย ย ย margin-bottom: 5px;
ย ย ย ย }

ย ย ย ย .reservation-details {
ย ย ย ย ย ย color: #666;
ย ย ย ย ย ย font-size: 14px;
ย ย ย ย ย ย line-height: 1.4;
ย ย ย ย }

ย ย ย ย .reservation-actions {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย gap: 10px;
ย ย ย ย }

ย ย ย ย .btn-action {
ย ย ย ย ย ย padding: 8px 16px;
ย ย ย ย ย ย font-size: 14px;
ย ย ย ย ย ย border-radius: 8px;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย transition: all 0.2s;
ย ย ย ย ย ย text-decoration: none;
ย ย ย ย ย ย display: inline-flex;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย gap: 5px;
ย ย ย ย }

ย ย ย ย .btn-confirm {
ย ย ย ย ย ย background: #25D366;
ย ย ย ย ย ย color: white;
ย ย ย ย }

ย ย ย ย .btn-checkin {
ย ย ย ย ย ย background: #2196F3;
ย ย ย ย ย ย color: white;
ย ย ย ย }

ย ย ย ย .btn-noshow {
ย ย ย ย ย ย background: #f44336;
ย ย ย ย ย ย color: white;
ย ย ย ย }

ย ย ย ย .btn-action:disabled {
ย ย ย ย ย ย opacity: 0.5;
ย ย ย ย ย ย cursor: not-allowed;
ย ย ย ย }

ย ย ย ย .status-badge {
ย ย ย ย ย ย display: inline-block;
ย ย ย ย ย ย padding: 4px 12px;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย font-size: 12px;
ย ย ย ย ย ย font-weight: 600;
ย ย ย ย ย ย margin-left: 10px;
ย ย ย ย }

ย ย ย ย .status-pending {
ย ย ย ย ย ย background: #FFF3E0;
ย ย ย ย ย ย color: #F57C00;
ย ย ย ย }

ย ย ย ย .status-confirmed {
ย ย ย ย ย ย background: #E8F5E9;
ย ย ย ย ย ย color: #388E3C;
ย ย ย ย }

ย ย ย ย .status-present {
ย ย ย ย ย ย background: #E3F2FD;
ย ย ย ย ย ย color: #1976D2;
ย ย ย ย }

ย ย ย ย .status-noshow {
ย ย ย ย ย ย background: #FFEBEE;
ย ย ย ย ย ย color: #C62828;
ย ย ย ย }

ย ย ย ย .empty-state {
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย padding: 60px 20px;
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
ย ย ย ย }

ย ย ย ย .empty-state h3 {
ย ย ย ย ย ย color: #999;
ย ย ย ย ย ย font-size: 20px;
ย ย ย ย ย ย margin-bottom: 10px;
ย ย ย ย }

ย ย ย ย .empty-state p {
ย ย ย ย ย ย color: #bbb;
ย ย ย ย }

ย ย ย ย .error-message {
ย ย ย ย ย ย background: #FFEBEE;
ย ย ย ย ย ย color: #C62828;
ย ย ย ย ย ย padding: 15px;
ย ย ย ย ย ย border-radius: 10px;
ย ย ย ย ย ย margin-bottom: 20px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-weight: 500;
ย ย ย ย }

ย ย ย ย /* Responsividade */
ย ย ย ย @media (max-width: 768px) {
ย ย ย ย ย ย .datetime-group {
ย ย ย ย ย ย ย ย grid-template-columns: 1fr;
ย ย ย ย ย ย }

ย ย ย ย ย ย .filters {
ย ย ย ย ย ย ย ย flex-direction: column;
ย ย ย ย ย ย }

ย ย ย ย ย ย .reservation-item {
ย ย ย ย ย ย ย ย flex-direction: column;
ย ย ย ย ย ย ย ย align-items: flex-start;
ย ย ย ย ย ย }

ย ย ย ย ย ย .reservation-actions {
ย ย ย ย ย ย ย ย margin-top: 15px;
ย ย ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย }

ย ย ย ย ย ย .btn-action {
ย ย ย ย ย ย ย ย flex: 1;
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย /* Loading */
ย ย ย ย .loading {
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย padding: 40px;
ย ย ย ย ย ย color: white;
ย ย ย ย }

ย ย ย ย .loading::after {
ย ย ย ย ย ย content: "...";
ย ย ย ย ย ย animation: dots 1.5s infinite;
ย ย ย ย }

ย ย ย ย @keyframes dots {
ย ย ย ย ย ย 0%, 20% { content: "."; }
ย ย ย ย ย ย 40% { content: ".."; }
ย ย ย ย ย ย 60%, 100% { content: "..."; }
ย ย ย ย }
ย ย </style>
</head>
<body>
ย ย <div class="container">
ย ย ย ย <!-- Interface Cliente -->
ย ย ย ย <div class="client-view" id="clientView">
ย ย ย ย ย ย <div class="reservation-card" id="reservationForm">
ย ย ย ย ย ย ย ย <h1>Reserve sua Mesa</h1>
ย ย ย ย ย ย ย ย <p class="subtitle">Preencha os dados abaixo para fazer sua reserva</p>
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย <form id="bookingForm">
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="name">Nome Completo</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input type="text" id="name" required placeholder="Digite seu nome">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="phone">Telefone</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input type="tel" id="phone" required placeholder="(11) 98765-4321">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <div class="datetime-group">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <label for="date">Data</label>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <input type="date" id="date" required>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <label for="time">Horรกrio</label>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <select id="time" required>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="">Selecione</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="people">Nรบmero de Pessoas</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="people" required>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="">Selecione</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="1">1 pessoa</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="2">2 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="3">3 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="4">4 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="5">5 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="6">6 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="7">7 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="8">8 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="9">9 pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="10">10+ pessoas</option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <button type="submit">Fazer Reserva</button>
ย ย ย ย ย ย ย ย </form>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย <!-- Interface Host -->
ย ย ย ย <div class="host-view" id="hostView">
ย ย ย ย ย ย <div class="host-header">
ย ย ย ย ย ย ย ย <div class="host-title">
ย ย ย ย ย ย ย ย ย ย <h1>Painel de Reservas</h1>
ย ย ย ย ย ย ย ย ย ย <div id="currentDateTime"></div>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย <div class="filters">
ย ย ย ย ย ย ย ย ย ย <div class="filter-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="filterDate">Data:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input type="date" id="filterDate">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <div class="filter-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="filterTime">Horรกrio:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="filterTime">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="">Todos</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="11:00">11:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="11:30">11:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="12:00">12:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="12:30">12:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="13:00">13:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="13:30">13:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="14:00">14:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="18:00">18:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="18:30">18:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="19:00">19:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="19:30">19:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="20:00">20:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="20:30">20:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="21:00">21:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="21:30">21:30</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="22:00">22:00</option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย <div class="filter-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="filterStatus">Status:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="filterStatus">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="">Todos</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="pending">Pendente</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="confirmed">Confirmada</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="present">Presente</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option value="noshow">Nรฃo Compareceu</option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย </div>
ย ย ย ย ย ยย
ย ย ย ย ย ย <div class="reservations-grid" id="reservationsList">
ย ย ย ย ย ย ย ย <div class="loading">Carregando reservas</div>
ย ย ย ย ย ย </div>
ย ย ย ย </div>
ย ย </div>

ย ย <!-- Firebase -->
ย ย <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
ย ย <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
ย ยย
ย ย <script>
ย ย ย ย // ============= CONFIGURAรรES DO SISTEMA =============
ย ย ย ย // Configure aqui o nรบmero mรกximo de reservas por horรกrio
ย ย ย ย const MAX_RESERVATIONS_PER_SLOT = 5; // ALTERE ESTE NรMERO CONFORME NECESSรRIO
ย ย ย ยย
ย ย ย ย // Horรกrios disponรญveis para reserva
ย ย ย ย const AVAILABLE_TIMES = [
ย ย ย ย ย ย "11:00", "11:30", "12:00", "12:30", "13:00", "13:30", "14:00",
ย ย ย ย ย ย "18:00", "18:30", "19:00", "19:30", "20:00", "20:30", "21:00", "21:30", "22:00"
ย ย ย ย ];

ย ย ย ย // Configuraรงรฃo do Firebase (adicione suas credenciais aqui)
ย ย ย ย const firebaseConfig = {
ย ย ย ย ย ย apiKey: "AIzaSyCGXNRpRxEqHQxyxzHmT6pcnxd6eFy8iQM",
ย ย ย ย ย ย authDomain: "sistema-de-reserva-56c90.firebaseapp.com",
ย ย ย ย ย ย projectId: "sistema-de-reserva-56c90",
ย ย ย ย ย ย storageBucket: "sistema-de-reserva-56c90.firebasestorage.app",
ย ย ย ย ย ย messagingSenderId: "818842876841",
ย ย ย ย ย ย appId: "1:818842876841:web:e616fa6aba6faeacf062b8"
ย ย ย ย };

ย ย ย ย // Inicializar Firebase (serรก ativado quando vocรช adicionar as credenciais)
ย ย ย ย let db = null;
ย ย ย ย if (firebaseConfig.apiKey !== "SUA_API_KEY") {
ย ย ย ย ย ย firebase.initializeApp(firebaseConfig);
ย ย ย ย ย ย db = firebase.firestore();
ย ย ย ย }

ย ย ย ย // Sistema de armazenamento local para demonstraรงรฃo
ย ย ย ย class LocalStorage {
ย ย ย ย ย ย constructor() {
ย ย ย ย ย ย ย ย this.reservations = this.loadReservations();
ย ย ย ย ย ย }

ย ย ย ย ย ย loadReservations() {
ย ย ย ย ย ย ย ย const stored = localStorage.getItem('reservations');
ย ย ย ย ย ย ย ย return stored ? JSON.parse(stored) : [];
ย ย ย ย ย ย }

ย ย ย ย ย ย saveReservations() {
ย ย ย ย ย ย ย ย localStorage.setItem('reservations', JSON.stringify(this.reservations));
ย ย ย ย ย ย }

ย ย ย ย ย ย addReservation(data) {
ย ย ย ย ย ย ย ย const reservation = {
ย ย ย ย ย ย ย ย ย ย ...data,
ย ย ย ย ย ย ย ย ย ย id: Date.now().toString(),
ย ย ย ย ย ย ย ย ย ย createdAt: new Date().toISOString()
ย ย ย ย ย ย ย ย };
ย ย ย ย ย ย ย ย this.reservations.push(reservation);
ย ย ย ย ย ย ย ย this.saveReservations();
ย ย ย ย ย ย ย ย return Promise.resolve(reservation);
ย ย ย ย ย ย }

ย ย ย ย ย ย getReservations(filters = {}) {
ย ย ย ย ย ย ย ย let filtered = [...this.reservations];
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย if (filters.date) {
ย ย ย ย ย ย ย ย ย ย filtered = filtered.filter(r => r.date === filters.date);
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย if (filters.time) {
ย ย ย ย ย ย ย ย ย ย filtered = filtered.filter(r => r.time === filters.time);
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย if (filters.status) {
ย ย ย ย ย ย ย ย ย ย filtered = filtered.filter(r => r.status === filters.status);
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย // Ordenar por data e hora
ย ย ย ย ย ย ย ย filtered.sort((a, b) => {
ย ย ย ย ย ย ย ย ย ย const dateCompare = a.date.localeCompare(b.date);
ย ย ย ย ย ย ย ย ย ย if (dateCompare !== 0) return dateCompare;
ย ย ย ย ย ย ย ย ย ย return a.time.localeCompare(b.time);
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย return Promise.resolve(filtered);
ย ย ย ย ย ย }

ย ย ย ย ย ย updateReservation(id, updates) {
ย ย ย ย ย ย ย ย const index = this.reservations.findIndex(r => r.id === id);
ย ย ย ย ย ย ย ย if (index !== -1) {
ย ย ย ย ย ย ย ย ย ย this.reservations[index] = { ...this.reservations[index], ...updates };
ย ย ย ย ย ย ย ย ย ย this.saveReservations();
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย return Promise.resolve();
ย ย ย ย ย ย }

ย ย ย ย ย ย onSnapshot(callback) {
ย ย ย ย ย ย ย ย // Simular real-time updates
ย ย ย ย ย ย ย ย setInterval(() => {
ย ย ย ย ย ย ย ย ย ย this.getReservations().then(callback);
ย ย ย ย ย ย ย ย }, 1000);
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย // Chamar imediatamente
ย ย ย ย ย ย ย ย this.getReservations().then(callback);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย // Usar armazenamento local se Firebase nรฃo estiver configurado
ย ย ย ย const storage = db ? null : new LocalStorage();

ย ย ย ย // Controle de visualizaรงรฃo
ย ย ย ย const urlParams = new URLSearchParams(window.location.search);
ย ย ย ย const isHostView = urlParams.get('view') === 'host';

ย ย ย ย if (isHostView) {
ย ย ย ย ย ย document.getElementById('clientView').style.display = 'none';
ย ย ย ย ย ย document.getElementById('hostView').style.display = 'block';
ย ย ย ย ย ย initHostView();
ย ย ย ย } else {
ย ย ย ย ย ย initClientView();
ย ย ย ย }

ย ย ย ย // ============= FUNรรES DE DISPONIBILIDADE =============
ย ย ย ย async function checkSlotAvailability(date, time) {
ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย let confirmedCount = 0;

ย ย ย ย ย ย ย ย if (db) {
ย ย ย ย ย ย ย ย ย ย // Contar reservas confirmadas no Firebase
ย ย ย ย ย ย ย ย ย ย const snapshot = await db.collection('reservations')
ย ย ย ย ย ย ย ย ย ย ย ย .where('date', '==', date)
ย ย ย ย ย ย ย ย ย ย ย ย .where('time', '==', time)
ย ย ย ย ย ย ย ย ย ย ย ย .where('status', '==', 'confirmed')
ย ย ย ย ย ย ย ย ย ย ย ย .get();
ย ย ย ย ย ย ย ย ย ย confirmedCount = snapshot.docs.length;
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย // Contar reservas confirmadas localmente
ย ย ย ย ย ย ย ย ย ย const reservations = await storage.getReservations({ date, time });
ย ย ย ย ย ย ย ย ย ย confirmedCount = reservations.filter(r => r.status === 'confirmed').length;
ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย return confirmedCount < MAX_RESERVATIONS_PER_SLOT;
ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error('Erro ao verificar disponibilidade:', error);
ย ย ย ย ย ย ย ย return true; // Em caso de erro, permitir reserva
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย async function updateTimeSlots(selectedDate) {
ย ย ย ย ย ย const timeSelect = document.getElementById('time');
ย ย ย ย ย ย timeSelect.innerHTML = '<option value="">Carregando...</option>';

ย ย ย ย ย ย if (!selectedDate) {
ย ย ย ย ย ย ย ย timeSelect.innerHTML = '<option value="">Selecione uma data primeiro</option>';
ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย }

ย ย ย ย ย ย const availableSlots = [];
ย ย ย ย ย ยย
ย ย ย ย ย ย for (const time of AVAILABLE_TIMES) {
ย ย ย ย ย ย ย ย const isAvailable = await checkSlotAvailability(selectedDate, time);
ย ย ย ย ย ย ย ย if (isAvailable) {
ย ย ย ย ย ย ย ย ย ย availableSlots.push(time);
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }

ย ย ย ย ย ย if (availableSlots.length === 0) {
ย ย ย ย ย ย ย ย timeSelect.innerHTML = '<option value="">Nenhum horรกrio disponรญvel</option>';
ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย timeSelect.innerHTML = '<option value="">Selecione um horรกrio</option>' +
ย ย ย ย ย ย ย ย ย ย availableSlots.map(time => `<option value="${time}">${time}</option>`).join('');
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย // ============= INTERFACE CLIENTE =============
ย ย ย ย function initClientView() {
ย ย ย ย ย ย // Definir data mรญnima como hoje
ย ย ย ย ย ย const today = new Date().toISOString().split('T')[0];
ย ย ย ย ย ย document.getElementById('date').min = today;
ย ย ย ย ย ย document.getElementById('date').value = today;

ย ย ย ย ย ย // Atualizar horรกrios quando a data for selecionada
ย ย ย ย ย ย document.getElementById('date').addEventListener('change', function(e) {
ย ย ย ย ย ย ย ย updateTimeSlots(e.target.value);
ย ย ย ย ย ย });

ย ย ย ย ย ย // Carregar horรกrios para hoje
ย ย ย ย ย ย updateTimeSlots(today);

ย ย ย ย ย ย // Formatar campo de telefone
ย ย ย ย ย ย document.getElementById('phone').addEventListener('input', function(e) {
ย ย ย ย ย ย ย ย let value = e.target.value.replace(/\D/g, '');
ย ย ย ย ย ย ย ย if (value.length > 0) {
ย ย ย ย ย ย ย ย ย ย if (value.length <= 11) {
ย ย ย ย ย ย ย ย ย ย ย ย value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย e.target.value = value;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย });

ย ย ย ย ย ย // Submissรฃo do formulรกrio
ย ย ย ย ย ย document.getElementById('bookingForm').addEventListener('submit', async function(e) {
ย ย ย ย ย ย ย ย e.preventDefault();
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย const date = document.getElementById('date').value;
ย ย ย ย ย ย ย ย const time = document.getElementById('time').value;

ย ย ย ย ย ย ย ย // Verificar disponibilidade antes de salvar
ย ย ย ย ย ย ย ย const isAvailable = await checkSlotAvailability(date, time);
ย ย ย ย ย ย ย ย if (!isAvailable) {
ย ย ย ย ย ย ย ย ย ย alert('Desculpe, este horรกrio nรฃo estรก mais disponรญvel. Por favor, escolha outro horรกrio.');
ย ย ย ย ย ย ย ย ย ย updateTimeSlots(date); // Atualizar lista de horรกrios
ย ย ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย const reservation = {
ย ย ย ย ย ย ย ย ย ย name: document.getElementById('name').value,
ย ย ย ย ย ย ย ย ย ย phone: document.getElementById('phone').value,
ย ย ย ย ย ย ย ย ย ย date: date,
ย ย ย ย ย ย ย ย ย ย time: time,
ย ย ย ย ย ย ย ย ย ย people: document.getElementById('people').value,
ย ย ย ย ย ย ย ย ย ย status: 'pending'
ย ย ย ย ย ย ย ย };

ย ย ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย ย ย let reservationId;
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย if (db) {
ย ย ย ย ย ย ย ย ย ย ย ย // Salvar no Firebase
ย ย ย ย ย ย ย ย ย ย ย ย const docRef = await db.collection('reservations').add({
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ...reservation,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย createdAt: firebase.firestore.FieldValue.serverTimestamp()
ย ย ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย ย ย ย ย reservationId = docRef.id;
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย // Salvar localmente
ย ย ย ย ย ย ย ย ย ย ย ย const result = await storage.addReservation(reservation);
ย ย ย ย ย ย ย ย ย ย ย ย reservationId = result.id;
ย ย ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย ย ย // Mostrar confirmaรงรฃo
ย ย ย ย ย ย ย ย ย ย showConfirmation(reservation, reservationId);
ย ย ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย ย ย console.error('Erro ao fazer reserva:', error);
ย ย ย ย ย ย ย ย ย ย alert('Erro ao processar reserva. Por favor, tente novamente.');
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย function showConfirmation(reservation, reservationId) {
ย ย ย ย ย ย const formattedDate = new Date(reservation.date + 'T00:00:00').toLocaleDateString('pt-BR');
ย ย ย ย ย ยย
ย ย ย ย ย ย document.getElementById('reservationForm').innerHTML = `
ย ย ย ย ย ย ย ย <div class="confirmation">
ย ย ย ย ย ย ย ย ย ย <h2>๐ Reserva Registrada!</h2>
ย ย ย ย ย ย ย ย ย ย <p>Iremos confirmar via WhatsApp em breve.</p>
ย ย ย ย ย ย ย ย ย ย <p><strong>Nome:</strong> ${reservation.name}</p>
ย ย ย ย ย ย ย ย ย ย <p><strong>Data:</strong> ${formattedDate}</p>
ย ย ย ย ย ย ย ย ย ย <p><strong>Horรกrio:</strong> ${reservation.time}</p>
ย ย ย ย ย ย ย ย ย ย <p><strong>Pessoas:</strong> ${reservation.people}</p>
ย ย ย ย ย ย ย ย ย ย <p><strong>Telefone:</strong> ${reservation.phone}</p>
ย ย ย ย ย ย ย ย ย ย <p style="color: #999; font-size: 14px; margin-top: 20px;">
ย ย ย ย ย ย ย ย ย ย ย ย Cรณdigo da reserva: #${reservationId.substring(0, 8).toUpperCase()}
ย ย ย ย ย ย ย ย ย ย </p>
ย ย ย ย ย ย ย ย ย ย <p style="color: #666; font-size: 13px; margin-top: 15px;">
ย ย ย ย ย ย ย ย ย ย ย ย Aguarde nossa confirmaรงรฃo pelo WhatsApp. Caso nรฃo receba em atรฉ 30 minutos, entre em contato conosco.
ย ย ย ย ย ย ย ย ย ย </p>
ย ย ย ย ย ย ย ย ย ย <button class="btn-new" onclick="location.reload()">
ย ย ย ย ย ย ย ย ย ย ย ย Fazer Nova Reserva
ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย `;
ย ย ย ย }

ย ย ย ย // ============= INTERFACE HOST =============
ย ย ย ย function initHostView() {
ย ย ย ย ย ย // Mostrar data/hora atual
ย ย ย ย ย ย function updateDateTime() {
ย ย ย ย ย ย ย ย const now = new Date();
ย ย ย ย ย ย ย ย const options = {ย
ย ย ย ย ย ย ย ย ย ย weekday: 'long',ย
ย ย ย ย ย ย ย ย ย ย year: 'numeric',ย
ย ย ย ย ย ย ย ย ย ย month: 'long',ย
ย ย ย ย ย ย ย ย ย ย day: 'numeric',
ย ย ย ย ย ย ย ย ย ย hour: '2-digit',
ย ย ย ย ย ย ย ย ย ย minute: '2-digit'
ย ย ย ย ย ย ย ย };
ย ย ย ย ย ย ย ย document.getElementById('currentDateTime').textContent =ย
ย ย ย ย ย ย ย ย ย ย now.toLocaleDateString('pt-BR', options);
ย ย ย ย ย ย }
ย ย ย ย ย ย updateDateTime();
ย ย ย ย ย ย setInterval(updateDateTime, 60000);

ย ย ย ย ย ย // Definir filtro de data para hoje
ย ย ย ย ย ย const today = new Date().toISOString().split('T')[0];
ย ย ย ย ย ย document.getElementById('filterDate').value = today;

ย ย ย ย ย ย // Configurar listeners dos filtros
ย ย ย ย ย ย document.getElementById('filterDate').addEventListener('change', loadReservations);
ย ย ย ย ย ย document.getElementById('filterTime').addEventListener('change', loadReservations);
ย ย ย ย ย ย document.getElementById('filterStatus').addEventListener('change', loadReservations);

ย ย ย ย ย ย // Carregar reservas
ย ย ย ย ย ย if (db) {
ย ย ย ย ย ย ย ย // Real-time updates do Firebase
ย ย ย ย ย ย ย ย db.collection('reservations')
ย ย ย ย ย ย ย ย ย ย .onSnapshot(() => {
ย ย ย ย ย ย ย ย ย ย ย ย loadReservations();
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย // Updates locais
ย ย ย ย ย ย ย ย storage.onSnapshot(() => {
ย ย ย ย ย ย ย ย ย ย loadReservations();
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย }

ย ย ย ย ย ย loadReservations();
ย ย ย ย }

ย ย ย ย async function loadReservations() {
ย ย ย ย ย ย const filters = {
ย ย ย ย ย ย ย ย date: document.getElementById('filterDate').value,
ย ย ย ย ย ย ย ย time: document.getElementById('filterTime').value,
ย ย ย ย ย ย ย ย status: document.getElementById('filterStatus').value
ย ย ย ย ย ย };

ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย let reservations = [];

ย ย ย ย ย ย ย ย if (db) {
ย ย ย ย ย ย ย ย ย ย // Buscar do Firebase
ย ย ย ย ย ย ย ย ย ย let query = db.collection('reservations');
ย ย ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย ย ย if (filters.date) {
ย ย ย ย ย ย ย ย ย ย ย ย query = query.where('date', '==', filters.date);
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย if (filters.time) {
ย ย ย ย ย ย ย ย ย ย ย ย query = query.where('time', '==', filters.time);
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย if (filters.status) {
ย ย ย ย ย ย ย ย ย ย ย ย query = query.where('status', '==', filters.status);
ย ย ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย ย ย const snapshot = await query.get();
ย ย ย ย ย ย ย ย ย ย reservations = snapshot.docs.map(doc => ({
ย ย ย ย ย ย ย ย ย ย ย ย id: doc.id,
ย ย ย ย ย ย ย ย ย ย ย ย ...doc.data()
ย ย ย ย ย ย ย ย ย ย }));

ย ย ย ย ย ย ย ย ย ย // Ordenar
ย ย ย ย ย ย ย ย ย ย reservations.sort((a, b) => {
ย ย ย ย ย ย ย ย ย ย ย ย const timeCompare = a.time.localeCompare(b.time);
ย ย ย ย ย ย ย ย ย ย ย ย if (timeCompare !== 0) return timeCompare;
ย ย ย ย ย ย ย ย ย ย ย ย return (a.createdAt?.seconds || 0) - (b.createdAt?.seconds || 0);
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย // Buscar localmente
ย ย ย ย ย ย ย ย ย ย reservations = await storage.getReservations(filters);
ย ย ย ย ย ย ย ย }

ย ย ย ย ย ย ย ย displayReservations(reservations);
ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error('Erro ao carregar reservas:', error);
ย ย ย ย ย ย ย ย document.getElementById('reservationsList').innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="empty-state">
ย ย ย ย ย ย ย ย ย ย ย ย <h3>Erro ao carregar reservas</h3>
ย ย ย ย ย ย ย ย ย ย ย ย <p>Por favor, recarregue a pรกgina</p>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function displayReservations(reservations) {
ย ย ย ย ย ย const container = document.getElementById('reservationsList');
ย ย ย ย ย ยย
ย ย ย ย ย ย if (reservations.length === 0) {
ย ย ย ย ย ย ย ย container.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="empty-state">
ย ย ย ย ย ย ย ย ย ย ย ย <h3>Nenhuma reserva encontrada</h3>
ย ย ย ย ย ย ย ย ย ย ย ย <p>Ajuste os filtros ou aguarde novas reservas</p>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย }

ย ย ย ย ย ย container.innerHTML = reservations.map(reservation => {
ย ย ย ย ย ย ย ย const statusClass = `status-${reservation.status}`;
ย ย ย ย ย ย ย ย const statusText = getStatusText(reservation.status);
ย ย ย ย ย ย ย ย const formattedDate = new Date(reservation.date + 'T00:00:00').toLocaleDateString('pt-BR');
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย // Limpar nรบmero de telefone para WhatsApp
ย ย ย ย ย ย ย ย const cleanPhone = reservation.phone.replace(/\D/g, '');
ย ย ย ย ย ย ย ย const whatsappNumber = cleanPhone.startsWith('55') ? cleanPhone : `55${cleanPhone}`;
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย // Mensagem formatada para WhatsApp
ย ย ย ย ย ย ย ย const whatsappMessage = encodeURIComponent(
ย ย ย ย ย ย ย ย ย ย `Olรก ${reservation.name}! ๐\n\n` +
ย ย ย ย ย ย ย ย ย ย `Sua reserva foi confirmada! โ\n\n` +
ย ย ย ย ย ย ย ย ย ย `๐ *Detalhes da Reserva:*\n` +
ย ย ย ย ย ย ย ย ย ย `๐ Data: ${formattedDate}\n` +
ย ย ย ย ย ย ย ย ย ย `โฐ Horรกrio: ${reservation.time}\n` +
ย ย ย ย ย ย ย ย ย ย `๐ฅ Pessoas: ${reservation.people}\n\n` +
ย ย ย ย ย ย ย ย ย ย `Por favor, chegue com 10 minutos de antecedรชncia.\n\n` +
ย ย ย ย ย ย ย ย ย ย `Aguardamos vocรชs! ๐ฝ๏ธ`
ย ย ย ย ย ย ย ย );
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย return `
ย ย ย ย ย ย ย ย ย ย <div class="reservation-item">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="reservation-info">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="reservation-name">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ${reservation.name}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <span class="status-badge ${statusClass}">${statusText}</span>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="reservation-details">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ๐ ${formattedDate} รs ${reservation.time}<br>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ๐ฅ ${reservation.people} pessoa${reservation.people > 1 ? 's' : ''}<br>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ๐ฑ ${reservation.phone}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="reservation-actions">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <a class="btn-action btn-confirm"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยhref="https://wa.me/${whatsappNumber}?text=${whatsappMessage}"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยtarget="_blank"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยonclick="updateStatus('${reservation.id}', 'confirmed')"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย${reservation.status !== 'pending' ? 'style="pointer-events: none; opacity: 0.5;"' : ''}>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย Confirmar
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </a>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-action btn-checkin"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย onclick="updateStatus('${reservation.id}', 'present')"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ${reservation.status !== 'confirmed' ? 'disabled' : ''}>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย Check-in
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-action btn-noshow"ย
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย onclick="updateStatus('${reservation.id}', 'noshow')"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ${reservation.status === 'present' || reservation.status === 'noshow' ? 'disabled' : ''}>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย Nรฃo Compareceu
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย }).join('');
ย ย ย ย }

ย ย ย ย function getStatusText(status) {
ย ย ย ย ย ย const statusMap = {
ย ย ย ย ย ย ย ย 'pending': 'Pendente',
ย ย ย ย ย ย ย ย 'confirmed': 'Confirmada',
ย ย ย ย ย ย ย ย 'present': 'Presente',
ย ย ย ย ย ย ย ย 'noshow': 'Nรฃo Compareceu'
ย ย ย ย ย ย };
ย ย ย ย ย ย return statusMap[status] || status;
ย ย ย ย }

ย ย ย ย async function updateStatus(reservationId, newStatus) {
ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย if (db) {
ย ย ย ย ย ย ย ย ย ย // Atualizar no Firebase
ย ย ย ย ย ย ย ย ย ย await db.collection('reservations').doc(reservationId).update({
ย ย ย ย ย ย ย ย ย ย ย ย status: newStatus,
ย ย ย ย ย ย ย ย ย ย ย ย updatedAt: firebase.firestore.FieldValue.serverTimestamp()
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย // Atualizar localmente
ย ย ย ย ย ย ย ย ย ย await storage.updateReservation(reservationId, { status: newStatus });
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ยย
ย ย ย ย ย ย ย ย // Recarregar lista
ย ย ย ย ย ย ย ย loadReservations();
ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error('Erro ao atualizar status:', error);
ย ย ย ย ย ย ย ย alert('Erro ao atualizar status. Por favor, tente novamente.');
ย ย ย ย ย ย }
ย ย ย ย }
ย ย </script>
</body>
</html>
